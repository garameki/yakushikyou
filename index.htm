<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>薬師瑠璃光如来本願功徳経　全文(禅門曹洞宗典)</title>
<style type="text/css">
body{
  -ms-writing-mode: tb-rl;
  writing-mode: vertical-rl;
  font:black;
}
img {
	width:20px;
}
</style>
<script type="application/javascript" src="http://garameki.com/articles/yakushikyou/ruby.js"></script>
<script type="application/javascript" src="http://garameki.com/articles/yakushikyou/text.js"></script>
<script type="application/javascript" src="http://garameki.com/articles/yakushikyou/key.js"></script>
<script type="application/javascript">
const start = function() {




	/* 出典　來馬琢道　著　禅門曹洞宗典　大正八年七月初刊　版 */
	/* 著作権 国立国会図書館デジタルコレクション Copyright © 2011 National Diet Library. All Rights Reserved. */
	/* インターネット公開（保護期間満了）Reserved period has been passed yet. */
	/* LINK http://dl.ndl.go.jp/info:ndljp/pid/961952 */
	


	/* decompress */
	/* 
		***global variable***
			keyletter
			comp2
	*/
	let letter;
	const keyletters = keyletter.match(/.{2}/g);
	let count = 0x3a;
	const pairs = [ ];
	for(letter of keyletters) {
		pairs[String.fromCharCode(count++)] = letter;
	}
	console.log("pairs");
	console.log(pairs);
	let comp = "";
	for(letter of comp2) {
		comp += String.fromCharCode(letter.charCodeAt(0)-1);
	}
	console.log("comp");
	console.log(comp);
	let sre,re;
	let decomp = comp;
	let nnn=0;
	for(key in pairs) {
		if(++nnn>100) break;
		sre = key.replace(/([\[\]\(\)+,.\\?])/g,'\\$1');
		console.log(nnn,"    ",sre);
		re = new RegExp(sre,"g");
		console.log(pairs[key]);
		decomp = decomp.replace(re,pairs[key]);
	}
	decomp = decomp.replace(/Z/g,' ');
	console.log("decomp");
	console.log(decomp);


	const letternames = decomp.split(" ");

	const id = document.getElementById('result');
	const reBNUM = /b\d+/g;
	const reNUM = /\d+/;
	let counterRuby = 0;
	let rubies = ruby.split(/\s/);
	console.log(rubies.length);
	let letters = [ ];
	for(letter of letternames) {
		if(letter == "n") {
			letters += "。";
		} else if(letter == "nl") {
			letters += "<br>";
		} else if(letter == "") {
			//nothing
		} else if(letter.match(reBNUM)) {
			let num = Number(letter.match(reNUM));
			for(let ii = 0;ii < num;ii++) {
					letters += '<img src="fonts/sp.png">';
			}
			console.log(num);
		} else {
			if(counterRuby < rubies.length) {
				letters += '<ruby><img src="fonts/' + letter + '.png"><rt>' + rubies[counterRuby] + '</rt></ruby>';;
				counterRuby++;
			} else {
				letters += '<img src="fonts/' + letter + '.png">';
			}
			
		}
	}
	id.innerHTML = letters;
}

onload = function() {
	let flag1,flag2;
	let count = 0;
	const hoge = setInterval(function() {
		//if(flagRuby && flagText && flagKey) {
		if(flagRuby) {
			clearInterval(hoge);
			start();
		} else {
			console.log(count);
			if(++count > 10) clearInterval(hoge);
		}
	},200);

};

</script>

</head>
<body>
<b>恭しく　みほとけを　礼拝したてまつる。</b><br><br><br>
<div id="result"></div>
<br><br><br>
&nbsp;&nbsp;雨ニモマケズ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;宮沢賢治<br>
雨ニモマケズ<br>
風ニモマケズ<br>
雪ニモ夏ノ暑サニモマケヌ<br>
丈夫ナカラダヲモチ
慾ハナク<br>
決シテ瞋ラズ<br>
イツモシヅカニワラッテヰル<br>
一日ニ玄米四合ト<br>
味噌ト少シノ野菜ヲタベ<br>
アラユルコトヲ<br>
ジブンヲカンヂャウニ入レズニ<br>
ヨクミキキシワカリ<br>
ソシテワスレズ<br>
野原ノ松ノ林ノ蔭ノ<br>
小サナ萱ブキノ小屋ニヰテ<br>
東ニ病気ノコドモアレバ<br>
行ッテ看病シテヤリ<br>
西ニツカレタ母アレバ<br>
行ッテソノ稲ノ束ヲ負ヒ<br>
南ニ死ニサウナ人アレバ<br>
行ッテコハガラナクテモイイトイヒ<br>
北ニケンクワヤソショウガアレバ<br>
ツマラナイカラヤメロトイヒ<br>
ヒデリノトキハナミダヲナガシ<br>
サムサノナツハオロオロアルキ<br>
ミンナニデクノボートヨバレ<br>
ホメラレモセズ<br>
クニモサレズ<br>
サウイフモノニ<br>
ワタシハナリタイ<br>
<br><br><br>
<b>ありがとうございました。深層の阿頼耶識に薫重しますように。</b><br>
</body></html>

